@model MedOffice.Models.Appointment

@{
    ViewBag.Title = "Tworzenie wizyty";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2>Utwórz nową wizytę</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h4>Wizyta</h4>
        <hr />

        <!--<script src="~/Scripts/jquery-1.10.2.min.js"></script>-->


        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

        <div class="form-group">
            @Html.LabelFor(model => model.patients_pesel, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.patients_pesel, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.patients_pesel, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.estim_disease, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.estim_disease, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.estim_disease, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.appoint_date, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input type="datetime" name="appoint_date" value="@DateTime.Now" />
                @Html.ValidationMessageFor(model => model.appoint_date, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.specialization, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(model => model.specialization, (IEnumerable<SelectListItem>)ViewBag.Spec, new { @class = "form-control" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.docs_pesel, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @*Html.DropDownListFor(model=> model.docs_pesel, (IEnumerable<SelectListItem>)ViewBag.D, "--select doc--", new { @class = "form-control" })*@
                @*Html.EditorFor(model => model.docs_pesel, new { htmlAttributes = new { @class = "form-control" } })*@

                @*Html.DropDownListFor(model => model.docs_pesel, (IEnumerable<SelectListItem>)ViewBag.D, new { @class = "form-control" })*@
                <select class="form-control" id="docs_pesel" name="docs_pesel">
                    <option></option>
                </select>
                @Html.ValidationMessageFor(model => model.docs_pesel, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.service_type, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <select class="form-control" name="service_type">
                    <option>konsultacja</option>
                    <option>wypisanie recept</option>
                    <option>zabieg</option>
                    <option>wizyta kontrolna</option>
                    <option>inne</option>
                </select>
                @Html.ValidationMessageFor(model => model.service_type, "", new { @class = "text-danger" })
            </div>
        </div>


        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Create" class="btn btn-default" />
            </div>
        </div>
    </div>
}
<div>
    @Html.ActionLink("Powrót do listy", "Index")
</div>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script type="text/javascript">
        $(document).ready(function () {
            $("#specialization").on('change', function () {
                var cos = $("#specialization option:selected").val();

                $.get("52746/Appointment/GetDocList", { specialization: $("#specialization option:selected").val() }, function () { alert("elo"); });
                //function (data) {
                //$("#docs_pesel").empty();
                //$.each(data, function (index, row) {
                //$("#docs_pesel").append("<option value='" + row.UserName + "'>" + row.Surname + "</option>");
            });
        });
    </script>


}
